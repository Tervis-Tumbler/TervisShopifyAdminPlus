<style>
    body {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        font-size: 1em; 
        line-height: 1.5;
    }
    button {
        padding: 10px 15px;
        margin: 0.5em 0em;
        border: 0px;
        background: #5563c1;
        color: white;
        font-weight: bold;
        font-size: 1em;
    }
    #ShopifyPOSPersonalizationForm {
        display: flex;
        flex-flow: column wrap;
        justify-content: space-around;
    }
    #PersonalizationInformationContainer {
        display: flex;
        flex-direction: column;
    }
    select {
        margin: 0.5em 0em;
        height: 2em;
        width: 100%;
        font-size: 1em;
    }
    input[type="text"] {
        margin: 0.5em 0em;
        height: 2em;
        font-size: 1em;
    }
    :checked + .labelText {
        color: #5563c1;
        /* font-weight: bold; */
    }
    label {
        margin: 0.5em 0em;
    }
    .PersonalizationPropertyName {
        font-weight: bold;
        color: slategray;
    }
    #Debug {
        display: none;
    }
</style>

<div id="content">Loading Personalization...</div>
<script type="module">
    import {
        Remove_ObjectKeyWithEmptyOrNullValue
    } from 'https://unpkg.com/@tervis/tervisutilityjs?module'

    // Refactor these functions into separate module once we are no longer embedded using admin+
    async function Get_TervisShopifyCart () {
        return new Promise((resolve, reject) => {
            ShopifyPOS.fetchCart({
                success: resolve,
                error: reject
            })
        })
    }
    window.Get_TervisShopifyCart = Get_TervisShopifyCart

    // https://help.shopify.com/en/api/embedded-apps/shopify-pos-app-sdk/methods#add-line-item
    async function Add_TervisShopifyCartLineItem ({
        $Cart,
        $Price,
        $Quantity,
        $Title,
        $VariantID
    }) {
        return new Promise(
            (resolve, reject) => {
                $Cart.addLineItem(
                    Remove_ObjectKeyWithEmptyOrNullValue({
                        price: $Price,
                        quantity: $Quantity,
                        title: $Title,
                        variant_id: $VariantID
                    }),
                    {
                        success: resolve,
                        error: reject
                    }
                )
            }
        )
    }
    window.Add_TervisShopifyCartLineItem = Add_TervisShopifyCartLineItem

    // https://help.shopify.com/en/api/embedded-apps/shopify-pos-app-sdk/methods#add-line-item-properties
    async function Add_TervisShopifyCartLineItemProperties ({
        $Cart,
        $LineItemIndex,
        $LineItemProperties
    }) {
        return new Promise(
            (resolve, reject) => {
                $Cart.addLineItemProperties(
                    $LineItemIndex,
                    $LineItemProperties,
                    {
                        success: resolve,
                        error: reject
                    }
                )
            }
        )
    }
    window.Add_TervisShopifyCartLineItemProperties = Add_TervisShopifyCartLineItemProperties

    async function Remove_TervisShopifyCartLineItem ({
        $Cart,
        $LineItemIndex
    }) {
        return new Promise(
            (resolve, reject) => {
                $Cart.removeLineItem(
                    $LineItemIndex,
                    {
                        success: resolve,
                        error: reject
                    }
                )
            }
        )
    }
    window.Remove_TervisShopifyCartLineItem = Remove_TervisShopifyCartLineItem
</script>

<script type="module" src="https://unpkg.com/@tervis/tervisshopifyadminpluspersonalizeit@0.1.322?module"></script>
